<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ticket Order</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: white;
      margin: 0;
      padding: 2em;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 2em;
      border-radius: 10px;
      box-shadow: 0 0 10px #ccc;
    }
    h2 {
      text-align: center;
    }
    label {
      display: block;
      margin-top: 1em;
    }
    input, button {
      width: 100%;
      padding: 0.6em;
      margin-top: 0.3em;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      background: #e7c670;
      font-weight: bold;
      cursor: pointer;
      border: none;
    }
    .lang-switch {
      display: flex;
      justify-content: center;
      margin-bottom: 1em;
      gap: 10px;
    }
    .lang-switch img {
      width: 30px;
      height: 20px;
      cursor: pointer;
      border: 2px solid transparent;
      border-radius: 3px;
    }
    .lang-switch img:hover {
      border-color: #e7c670;
    }
    .total {
      font-weight: bold;
      margin-top: 1em;
      text-align: center;
    }
    .hidden {
      display: none;
    }
    .fade {
      animation: fadeIn 0.6s ease-out forwards;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(10px);}
      to {opacity: 1; transform: translateY(0);}
    }
  </style>
</head>
<body>
<div class="container">

  <div class="lang-switch">
    <img src="https://flagcdn.com/w40/gb.png" alt="EN" onclick="setLang('en')">
    <img src="https://flagcdn.com/w40/ru.png" alt="RU" onclick="setLang('ru')">
    <img src="https://flagcdn.com/w40/il.png" alt="HE" onclick="setLang('he')">
  </div>

  <h2 data-lang-en="Ticket Order" data-lang-ru="Заказ билетов" data-lang-he="הזמנת כרטיסים">Ticket Order</h2>

  <form id="ticketForm" action="https://formsubmit.co/ajax/2mmedia.il@gmail.com" method="POST">
    <label data-lang-en="Competition Day Tickets (40₪ each)" 
           data-lang-ru="Билеты на конкурсный день (40₪ за шт.)" 
           data-lang-he="כרטיסים ליום התחרות (₪40 כל אחד)">
      Competition Day Tickets (40₪ each)
    </label>
    <input type="number" name="competition_tickets" min="0" value="0" oninput="calculateTotal()" required>

    <label data-lang-en="Gala Concert Tickets (60₪ each)" 
           data-lang-ru="Билеты на гала-концерт (60₪ за шт.)" 
           data-lang-he="כרטיסים לקונצרט הגאלה (₪60 כל אחד)">
      Gala Concert Tickets (60₪ each)
    </label>
    <input type="number" name="gala_tickets" min="0" value="0" oninput="calculateTotal()" required>

    <label data-lang-en="First Name" data-lang-ru="Имя" data-lang-he="שם פרטי">First Name</label>
    <input type="text" name="first_name" required>

    <label data-lang-en="Last Name" data-lang-ru="Фамилия" data-lang-he="שם משפחה">Last Name</label>
    <input type="text" name="last_name" required>

    <label data-lang-en="Phone Number" data-lang-ru="Номер телефона" data-lang-he="מספר טלפון">Phone Number</label>
    <input type="tel" name="phone" required>

    <label data-lang-en="Email (optional)" data-lang-ru="Email (необязательно)" data-lang-he="אימייל (לא חובה)">
      Email (optional)
    </label>
    <input type="email" name="email">

    <div class="total" id="totalDisplay">Total: 0₪</div>
    <input type="hidden" name="calculated_total" id="totalField">
    <input type="text" name="_honey" style="display:none">

    <button type="submit" 
            data-lang-en="Submit Order" 
            data-lang-ru="Отправить заказ" 
            data-lang-he="שלח הזמנה">
      Submit Order
    </button>
  </form>

  <div id="thankYou" class="hidden fade" style="text-align: center; margin-top: 2em;">
    <p id="message"
       data-lang-en="We will contact you to arrange payment." 
       data-lang-ru="С вами свяжутся для оплаты." 
       data-lang-he="ניצור איתך קשר כדי להסדיר את התשלום.">
      We will contact you to arrange payment.
    </p>
    <button onclick="resetForm()" 
            data-lang-en="Add Another Order" 
            data-lang-ru="Добавить ещё заказ" 
            data-lang-he="הוסף הזמנה נוספת">
      Add Another Order
    </button>
  </div>

</div>

<script>
  const translations = document.querySelectorAll("[data-lang-en]");
  function setLang(lang) {
    translations.forEach(el => {
      const text = el.getAttribute("data-lang-" + lang);
      if (text) el.textContent = text;
    });
  }

  function calculateTotal() {
    const comp = +document.querySelector('[name="competition_tickets"]').value || 0;
    const gala = +document.querySelector('[name="gala_tickets"]').value || 0;
    let total = comp * 40 + gala * 60;
    const count = comp + gala;
    if (count >= 3) {
      total = Math.round(total * 0.65); // 35% discount
    }
    document.getElementById("totalDisplay").textContent = "Total: " + total + "₪";
    document.getElementById("totalField").value = total + "₪";
  }

  calculateTotal();

  document.getElementById("ticketForm").addEventListener("submit", function (e) {
    e.preventDefault();
    const form = e.target;
    const data = new FormData(form);
    fetch(form.action, {
      method: "POST",
      body: data,
      headers: { 'Accept': 'application/json' }
    }).then(response => {
      if (response.ok) {
        form.classList.add("hidden");
        document.getElementById("thankYou").classList.remove("hidden");
        document.getElementById("thankYou").classList.add("fade");
      } else {
        alert("There was a problem sending the form.");
      }
    });
  });

  function resetForm() {
    const form = document.getElementById("ticketForm");
    form.reset();
    calculateTotal();
    form.classList.remove("hidden");
    document.getElementById("thankYou").classList.add("hidden");
  }
</script>
</body>
</html>
